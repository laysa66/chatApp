# ws-chat :

## Pr√©sentation

**ws-chat** est une application de chat temps r√©el, organis√©e en monorepo avec Yarn Workspaces. Elle comprend :
- Un frontend Vue 3 (Vite)
- Un backend Node.js/Express
- Un module `common` partag√© (types, utilitaires)
- Une base de donn√©es PostgreSQL
- Un reverse proxy Traefik pour le routage et les certificats SSL

Le d√©ploiement et l'orchestration sont assur√©s par Docker et Docker Compose.

---

## Structure du projet

```
chat_app/
‚îú‚îÄ‚îÄ packages/
‚îÇ   ‚îú‚îÄ‚îÄ common/      # Typescript: types et utilitaires partag√©s
‚îÇ   ‚îú‚îÄ‚îÄ front/       # Frontend Vue 3 + Vite
‚îÇ   ‚îú‚îÄ‚îÄ server/      # Backend Node.js/Express/TypeScript
‚îÇ   ‚îî‚îÄ‚îÄ deploy/      # Docker Compose, Traefik, DB init
‚îú‚îÄ‚îÄ package.json     # Monorepo root, scripts globaux
‚îî‚îÄ‚îÄ README.MD
```

---

## Composants principaux

### Frontend (`packages/front`)
- Vue 3 + Vite
- Pinia (state management)
- Vue Router
- Socket.IO Client
- Authentification par token stock√© dans un cookie s√©curis√© (js-cookie)
- Configuration via `.env`

### Backend (`packages/server`)
- Node.js + Express + TypeScript
- API RESTful
- Authentification JWT
- Chiffrement des mots de passe avec bcrypt
- Socket.IO
- PostgreSQL
- Variables d'environnement via fichiers `config/`

### Common (`packages/common`)
- Types TypeScript et utilitaires partag√©s

### Orchestration & D√©ploiement (`packages/deploy`)
- `docker-compose.yaml` : tous les services (front, back, db, traefik)
- Traefik : reverse proxy, HTTPS, routage sous-domaines
- DB : initialisation via script SQL

---

## Pr√©requis
- Docker & Docker Compose
- Node.js >= 18.12.0 (si vous souhaitez d√©velopper en local sans Docker)
- Yarn >= 1.22 (si vous souhaitez d√©velopper en local sans Docker)

---

## Lancement du projet en local

### **D√©veloppement local avec Yarn**
Pour d√©velopper chaque service s√©par√©ment (hot reload, debug, etc.) :
> **Assurez-vous d'√™tre dans le dossier racine (`chat_app/`) avant d'ex√©cuter ces commandes.**

```bash
yarn install
# Si la base de donn√©es est d√©j√† d√©marr√©e, passez cette √©tape. Sinon, lancez-la avec :
yarn run dev:dependencies:up
yarn run dev
```

### **Lancement en mode production build√© (de preference)**
Pour lancer toute la stack comme en production, il suffit d'utiliser Docker Compose :
```bash
docker compose -f packages/deploy/docker-compose-dev.yaml up -d --build
```

- Tous les services (front, back, db, traefik) sont lanc√©s en mode d√©tach√©.
- Les images sont build√©es automatiquement si besoin.
- Les variables d‚Äôenvironnement sont inject√©es via les fichiers `.env` de chaque package.

Pour arr√™ter la stack :
```bash
docker compose -f packages/deploy/docker-compose-dev.yaml down
```

---

## Acc√®s √† l'application
- Frontend : http://localhost:3000 
- Backend API : http://localhost:4000

---
## Connexion avec comptes de test (Seed Data)

Vous pouvez vous connecter en utilisant un des comptes suivants, **qui SONT des donn√©es de test (seed data)** :

- üëâ **En tant qu'administrateur :**  
  `alice@example.com` / `password1`

- üëâ **En tant qu'utilisateur simple :**  
  `bob@example.com` / `password2`

Pour plus d'informations sur l'utilisation des seed data dans une base de donn√©es, consultez la documentation officielle :  
https://learn.microsoft.com/en-us/ef/core/modeling/data-seeding

```Vous pouvez cr√©er des comptes pour une exp√©rience compl√®te aussi```


---


## S√©curit√© & bonnes pratiques
- Les tokens sont stock√©s dans des cookies s√©curis√©s (js-cookie)
- Les imports partag√©s utilisent le dossier `common` via des imports relatifs
- Les variables sensibles sont dans des fichiers `.env` non versionn√©s
- Traefik g√®re le HTTPS et le routage (uniquement en production finale sur le serveur)
- La base de donn√©es est initialis√©e avec un script SQL pour cr√©er les tables n√©cessaires et le jeu de donn√©es initial pour la d√©monstration.

---

## Scripts utiles
- Build global : `yarn build`
- Lancer le projet en mode dev : `yarn dev`
- Lancer la stack docker en mode production : `yarn prod:docker:dev:up`
- Arr√™ter la stack docker : `yarn prod:docker:dev:down`
- Lancer uniquement la DB : `yarn dev:dependencies:up`
- Arr√™ter uniquement la DB : `yarn dev:dependencies:down`
- Lint global : `yarn lint`

---

## R√©f√©rences
- [Yarn Workspaces](https://classic.yarnpkg.com/lang/en/docs/workspaces/)
- [Vue 3](https://vuejs.org/)
- [Vite](https://vitejs.dev/)
- [Pinia](https://pinia.vuejs.org/)
- [Socket.IO](https://socket.io/)
- [Traefik](https://doc.traefik.io/traefik/)
- [Docker Compose](https://docs.docker.com/compose/)

---


